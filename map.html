<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <style>
    body { margin:0;position:fixed;top:0;right:0;bottom:0;left:0; }
    
    .hidden {
        display: none;
    }
    div.tooltip {
        color: #222;
        background-color: #fff;
        padding: .5em;
        text-shadow: #f5f5f5 0 1px 0;
        border-radius: 2px;
        opacity: 0.9;
        position: absolute;
    }
    
  </style>
</head>

<body>
  <script>
		var width = 700,
  		  height = 580;

		var svg = d3.select( "body" )
  		.append( "svg" )
		  .attr( "width", width )
		  .attr( "height", height );

    var projection = d3.geoConicConformal().center([2.454071, 46.279229]).scale(2800); // d3.geo.albersUsa avec d3 version 3
    			//.translate([width/2, height/2])

    var path = d3.geoPath() // d3.geo.path avec d3 version 3
                 .projection(projection);
    
		d3.json("regions.json", function(json) {
	    svg.selectAll("path")
           .data(json.features)
           .enter()
           .append("path")
           .attr("d", path)
           .style('fill', '#e5f5e0');
		});
    
    
    d3.csv("newData.csv", function(data) {
    //color.domain([0, 2000]);
    
      svg.selectAll("rect")
      	.data(data)
      	.enter()
      	.append("rect")
        .style("fill", function(d) {
			return 'red';
		  })
      	.attr('width', 30)
      	.attr('height', 30)
      	.attr('x', function(d){
			console.log(d.Coordonnees.split(', '))
			return projection(parseFloat(d.Coordonnees.split(', ')[1]));
		})
      	.attr('y', function(d){
			console.log(d.Coordonnees.split(', '))
			projection(parseFloat(d.Coordonnees.split(', ')[0]));
		})
      	.attr("transform", function(d) {
			console.log(d.Coordonnees)
			return "translate(" + projection([parseFloat(d.Coordonnees.split(',')[1]), parseFloat(d.Coordonnees.split(',')[0])])  + ")";
		});
      	/*.on('mousemove', function(d) {
                    var mouse = d3.mouse(svg.node()).map(function(d) {
                        return parseInt(d);
                    })
                    tooltip.classed('hidden', false)
                        .attr('style', 'left:' + (mouse[0] + 15) +
                                'px; top:' + (mouse[1] - 35) + 'px')
                        .html('hello');
                })
      					
        .on('mouseout', function() {
        tooltip.classed('hidden', true);
      });*/
    });

  </script>
</body>
